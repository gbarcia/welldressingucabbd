<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

    <sqlMap namespace="Proveedor">

   <typeAlias alias="proveedor" type="com.wd.dominio.Proveedor"/>

   <resultMap id="traerTodosLosProveedores" class="proveedor">
    <result property="rif" column="rif" />
    <result property="nombre" column="nombre" />
  </resultMap>

  <resultMap id="buscarProveedor" class="proveedor">
    <result property="rif" column="RIF" />
    <result property="nombre" column="NOMBRE" />
    <result property="telefono" column="TELEFONO" />
    <result property="nombreContacto" column="NOMBRECONTACTO" />
    <result property="apellidoContacto" column="APELLIDO_CONTACTO" />
    <result property="direccion" column="DIRECCION" />
    <result property="lugarID" column="IDLUGAR" />
    <result property="nombreCiudad" column="CIUDAD" />
  </resultMap>

    <insert id="agregarProveedor" parameterClass="proveedor">
        INSERT INTO EMPRESA_SERVICIO
        (rif,
        nombre,
        telefono,
        nombre_contacto,
        apellido_contacto,
        direccion,
        tipo,
        LUGAR_id) 
        VALUES (#rif#, #nombre#, #telefono#, #nombreContacto#, #apellidoContacto#,
        #direccion#,0,#lugarID#)
    </insert>

    <select id="TodosLosProveedores" resultMap="traerTodosLosProveedores">
        SELECT es.rif, es.nombre
        FROM EMPRESA_SERVICIO es
        WHERE tipo = 0
    </select>

    <select id="buscarUnProveedor" parameterClass="String" resultMap="buscarProveedor">
        SELECT
        es.rif RIF,
        es.nombre NOMBRE,
        es.telefono TELEFONO,
        es.nombre_contacto NOMBRECONTACTO,
        es.apellido_contacto APELLIDO_CONTACTO,
        es.direccion DIRECCION,
        es.LUGAR_id IDLUGAR,
        l.nombre CIUDAD
        FROM EMPRESA_SERVICIO es, LUGAR l
        WHERE l.id = es.LUGAR_id AND es.tipo = 0 AND es.rif = #value#
    </select>

    <update id="actualizarProveedor" parameterClass="proveedor">
        UPDATE EMPRESA_SERVICIO SET
        nombre= #nombre#,
        telefono = #telefono#,
        nombre_contacto = #nombreContacto#,
        apellido_contacto = #apellidoContacto#,
        direccion = #direccion#,
        LUGAR_id = #lugarID#
        WHERE rif = #rif#
    </update>
       
    </sqlMap>
